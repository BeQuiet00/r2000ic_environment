<?xml version="1.0"?>
<robot xmlns:xacro="http://wiki.ros.org/xacro">
  <xacro:include filename="$(find fanuc_resources)/urdf/common_materials.xacro"/>

  <xacro:macro name="fanuc_r2000ic125l" params="prefix">
    <!-- links: main serial chain -->
    <link name="${prefix}base_link">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/base_link.stl" />
        </geometry>
        <xacro:material_fanuc_gray40 />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/base_link.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="-0.0589648663227796 0.134200116749551 0.00547458963371417"
          rpy="0 0 0" />
        <mass
          value="79.4265587442076" />
        <inertia
          ixx="2.15281121006603"
          ixy="-0.11329003960186"
          ixz="-0.0256118794044203"
          iyy="4.1807420330578"
          iyz="0.00754987522675796"
          izz="3.2718961321262" />
      </inertial>
    </link>
    <link name="${prefix}link_1">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/link_1.stl" />
        </geometry>
        <xacro:material_fanuc_yellow />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/link_1.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="-0.0146188551218751 0.261336311721324 -0.0778801226933692"
          rpy="0 0 0" />
        <mass
          value="98.4447414677161" />
        <inertia
          ixx="3.54015126212754"
          ixy="-1.04534649523983"
          ixz="-0.544926692252298"
          iyy="5.14719282768335"
          iyz="-0.335394603229195"
          izz="4.95454477813311" />
      </inertial>
    </link>
    <link name="${prefix}link_2">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/link_2.stl" />
        </geometry>
        <xacro:material_fanuc_yellow />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/link_2.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="0.0428715316339108 0.424830287877023 -0.160333088027016"
          rpy="0 0 0" />
        <mass
          value="57.8340183615569" />
        <inertia
          ixx="7.20323248318394"
          ixy="-0.251100382441449"
          ixz="0.0219359368413988"
          iyy="0.770569300243738"
          iyz="0.795643805567422"
          izz="7.39893614081204" />
      </inertial>
    </link>
    <link name="${prefix}link_3">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/link_3.stl" />
        </geometry>
        <xacro:material_fanuc_yellow />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/link_3.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="0.376115797097515 0.145322344936816 0.196717251272584"
          rpy="0 0 0" />
        <mass
          value="62.7672796425545" />
        <inertia
          ixx="1.55328036855659"
          ixy="-1.75404342962931"
          ixz="-0.697791755533549"
          iyy="14.4666505631054"
          iyz="-0.267307649232387"
          izz="14.8007887231282" />
      </inertial>
    </link>
    <link name="${prefix}link_4">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/link_4.stl" />
        </geometry>
        <xacro:material_fanuc_yellow />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/link_4.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="0.125532432466578 -1.86065542973068E-08 -0.0240014962921646"
          rpy="0 0 0" />
        <mass
          value="3.77391712485386" />
        <inertia
          ixx="0.0103907506880208"
          ixy="7.26008866017942E-10"
          ixz="-0.00294677051456163"
          iyy="0.0361687859556413"
          iyz="4.8529452733311E-09"
          izz="0.0358501296030016" />
      </inertial>
    </link>
    <link name="${prefix}link_5">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/link_5.stl" />
        </geometry>
        <xacro:material_fanuc_yellow />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/link_5.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="0.0543158465023166 2.98365998574468E-10 -0.0587496229396575"
          rpy="0 0 0" />
        <mass
          value="6.55493498459228" />
        <inertia
          ixx="0.0581704674231251"
          ixy="-6.30093205715802E-11"
          ixz="0.0155297667861974"
          iyy="0.082931324304848"
          iyz="2.51023794909951E-11"
          izz="0.0545737275436082" />
      </inertial>
    </link>
    <link name="${prefix}link_6">
      <visual>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/visual/link_6.stl" />
        </geometry>
        <xacro:material_fanuc_black />
      </visual>
      <collision>
        <origin xyz="0 0 0" rpy="0 0 0"/>
        <geometry>
          <mesh filename="package://fanuc_r2000ic_support/meshes/r2000ic125l/collision/link_6.stl" />
        </geometry>
      </collision>
      <inertial>
        <origin
          xyz="0.0188963612278803 0 -0.0310752861847552"
          rpy="0 0 0" />
        <mass
          value="0.522292001248235" />
        <inertia
          ixx="0.00143474809666454"
          ixy="3.49428873747403E-21"
          ixz="4.85762026974708E-07"
          iyy="0.000772279049098994"
          iyz="-3.18249216211323E-20"
          izz="0.000772450968594439" />
      </inertial>
    </link>

    <!-- joints: main serial chain -->
    <joint name="${prefix}joint_1" type="revolute">
      <origin xyz="0 0.299 0" rpy="0 0 0"/>
      <parent link="${prefix}base_link"/>
      <child link="${prefix}link_1"/>
      <axis xyz="0 1 0"/>
      <limit lower="${radians(-185)}" upper="${radians(185)}" effort="0" velocity="${radians(130)}" />
    </joint>
    <joint name="${prefix}joint_2" type="revolute">
      <origin xyz="0.312 0.371 -0.056" rpy="0 0 0"/>
      <parent link="${prefix}link_1"/>
      <child link="${prefix}link_2"/>
      <axis xyz="0 0 -1"/>
      <limit lower="${radians(-60)}" upper="${radians(76)}" effort="0" velocity="${radians(115)}" />
    </joint>
    <joint name="${prefix}joint_3" type="revolute">
      <origin xyz="0 1.075 -0.17515" rpy="0 0 0"/>
      <parent link="${prefix}link_2"/>
      <child link="${prefix}link_3"/>
      <axis xyz="0 0 1"/>
      <limit lower="${radians(-121)}" upper="${radians(180)}" effort="0" velocity="${radians(125)}" />
    </joint>
    <joint name="${prefix}joint_4" type="revolute">
      <origin xyz="1.499 0.225 0.26215" rpy="0 0 0"/>
      <parent link="${prefix}link_3"/>
      <child link="${prefix}link_4"/>
      <axis xyz="1 0 0"/>
      <limit lower="${radians(-360)}" upper="${radians(360)}" effort="0" velocity="${radians(180)}" />
    </joint>
    <joint name="${prefix}joint_5" type="revolute">
      <origin xyz="0.231 0 0.0605" rpy="0 0 0"/>
      <parent link="${prefix}link_4"/>
      <child link="${prefix}link_5"/>
      <axis xyz="0 0 -1"/>
      <limit lower="${radians(-125)}" upper="${radians(125)}" effort="0" velocity="${radians(180)}" />
    </joint>
    <joint name="${prefix}joint_6" type="revolute">
      <origin xyz="0.179500000000001 0 -0.0605" rpy="0 0 0"/>
      <parent link="${prefix}link_5"/>
      <child link="${prefix}link_6"/>
      <axis xyz="1 0 0"/>
      <limit lower="${radians(-360)}" upper="${radians(360)}" effort="0" velocity="${radians(260)}" />
    </joint>

    <!-- ROS-Industrial 'base' frame: base_link to Fanuc World Coordinates transform -->
    <link name="${prefix}base" />
    <joint name="${prefix}base_link-base" type="fixed">
      <origin xyz="0 0 0.670" rpy="0 0 0"/>
      <parent link="${prefix}base_link"/>
      <child link="${prefix}base"/>
    </joint>

    <!-- ==================== Transmission =================== -->

    <!-- Manipulator Transmission Macro -->
    <xacro:macro name="manipulator_transmission" params="joint_index">
        <transmission name="trans_${joint_index}">
            <type>transmission_interface/SimpleTransmission</type>
            <joint name="joint_${joint_index}">
                <hardwareInterface>hardware_interface/PositionJointInterface</hardwareInterface>
            </joint>
            <actuator name="motor_${joint_index}">
                <mechanicalReduction>1</mechanicalReduction>
            </actuator>
        </transmission>
    </xacro:macro>

    <xacro:manipulator_transmission joint_index="1"/>
    <xacro:manipulator_transmission joint_index="2"/>
    <xacro:manipulator_transmission joint_index="3"/>
    <xacro:manipulator_transmission joint_index="4"/>
    <xacro:manipulator_transmission joint_index="5"/>
    <xacro:manipulator_transmission joint_index="6"/>

    <!-- ======================= Gazebo ====================== -->

    <!-- Manupulator Links Properties Macro -->
    <xacro:macro name="manipulator_link_properties" params="link">
        <gazebo reference="${link}">
            <kp>1000000000000</kp>
            <kd>0.00025</kd>
            <mu1>10.7</mu1>
            <mu2>10.7</mu2>
        </gazebo>
    </xacro:macro>

    <xacro:manipulator_link_properties link="base_link"/>
    <xacro:manipulator_link_properties link="link_1"/>
    <xacro:manipulator_link_properties link="link_2"/>
    <xacro:manipulator_link_properties link="link_3"/>
    <xacro:manipulator_link_properties link="link_4"/>
    <xacro:manipulator_link_properties link="link_5"/>
    <xacro:manipulator_link_properties link="link_6"/>

  </xacro:macro>
</robot>
